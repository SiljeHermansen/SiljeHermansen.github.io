\documentclass{beamer}
\title{Kjikvadrattesten}
\author{Silje Synn{\o}ve Lyder Hermansen}
\institute{\texttt{s.s.l.hermansen@stv.uio.no}\\}
\date{}
\usepackage{Sweave}
\begin{document}
\maketitle
\input{Forelesning7-concordance}

\begin{frame}
\title{Effekt av sosial bakgrunn\\
for lønnsforventning blant studenter}
\author{}
\institute{}
\maketitle
\end{frame}





\begin{frame}
\frametitle{Univariat analyse}
Gjennomsnittlig forventet lønn blant studenter ved HiØ er 614478. Hva kan forklare dette?
\begin{itemize}
\item $H_1$ Studenter som har foreldre med høy utdannelse forventer seg høyere lønnsnivå.
\item $H_2$ Studenter som studerer realfag forventer seg høyere lønnsnivå.
\item $H_3$ Studenter med foreldre med høy utdannelse velger realfag. Derfor forventer de seg høyere lønn.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Bivariat analyse -- gjennomsnittsverdier i krysstabell}
Gjennomsnittlig forventet lønn blant studenter ved HiØ er 614478. Hva kan forklare dette?
\begin{itemize}
\item $H_1$ Studenter som har foreldre med høy utdannelse forventer seg høyere lønnsnivå.
\item $H_2$ Studenter som studerer realfag forventer seg høyere lønnsnivå.
\end{itemize}
% latex table generated in R 3.0.2 by xtable 1.7-1 package
% Wed Nov 13 04:43:23 2013
\begin{table}[ht]
\centering
\begin{tabular}{rrr}
  \hline
 & Nei & Ja \\ 
  \hline
Studerer realfag & 521438 & 776190 \\ 
  Foreldres utdannelse & 473556 & 705071 \\ 
   \hline
\end{tabular}
\end{table}Vi finner at studenter som studerer realfag forventer seg 254752 mer i lønn enn andre studenter. Tilsvarende ser vi at studenter fra bedrestilte hjem forventer seg 231516 kr mer i året.
\end{frame}

\begin{frame}
\frametitle{Bivariat analyse -- Pearsons R}
Med en tellevariabel (Lønn) og to binære variabler (Foreldres utdanning og Studievalg), kan jeg gjøre en korrelasjonsanalyse for metriske variabler. Jeg gjør en Pearsons R:
% latex table generated in R 3.0.2 by xtable 1.7-1 package
% Wed Nov 13 04:43:23 2013
\begin{table}[ht]
\centering
\begin{tabular}{rrr}
  \hline
 & Pearson & R2 \\ 
  \hline
Foreldres utdanning og lønn & 0.31 & 0.10 \\ 
  Studerer realfag og lønn & 0.33 & 0.11 \\ 
  Realfag og foreldresutd. & 0.09 & 0.01 \\ 
   \hline
\end{tabular}
\end{table}Foreldres utdanning forklarer omtrent 10 prosent av forventet lønn.
Studievalg forklarer omtrent 11 prosent av forventet lønn. 
\end{frame}


\begin{frame}
\frametitle{Bivariat analyse -- gjennomsnittsverdier i krysstabell}
Foreløpig har vi testet to separate årsakssamenhenger:
\begin{figure}
\includegraphics[width=0.7\textwidth]{arsaksmodell1.pdf}
\end{figure}
Men med nærmere ettertanke finner vi at sosisal bakgrunn muligens påvirker hvilke studier man velger, og at dette kan forklare hvorfor realister forventer høyere lønn. Sosial bakgrunn må være bakenforliggende årsak, fordi den ligger foran studievalg i tid.
\end{frame}



\begin{frame}
\frametitle{Trivariatanalyse -- årsaksmodell}
Vi tester hypotese 3 om en spuriøs effekt mellom studievalg og forventet lønn. 
\begin{itemize}
\item $H_3$ Studenter med foreldre med høy utdannelse velger realfag. Derfor forventer de seg høyere lønn.
\end{itemize}
Allerede fra de lave verdiene til korrelasjonen mellom studievalg og sosialbakgrunn kan vi slutte at det er lite mulighet for en spuriøs effekt mellom lønn og studier. Men la oss forsøke likevel.
\end{frame}

\begin{frame}
\frametitle{Trivariatanalyse -- årsaksmodell}
\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{arsaksmodell2.pdf}
\end{figure}
\end{frame}


\begin{frame}
\frametitle{Trivariat tabell}
Vi ser at barn av høyt utdannede foreldre forventer seg høyere lønn enn andre, selv med likt kompetansenivå. Faktisk forventer de seg høyere lønn enn alle, uansett studieretning.
% latex table generated in R 3.0.2 by xtable 1.7-1 package
% Wed Nov 13 04:43:24 2013
\begin{table}[ht]
\centering
\begin{tabular}{rrr}
  \hline
 & Studerer ikke realfag & Studerer realfag \\ 
  \hline
Foreldre uten høyere utd. & 435806 & 557143 \\ 
  Foreldre med høyere utd. & 584643 & 885714 \\ 
   \hline
\end{tabular}
\caption{Gjennomsnittlig forventet lønn blant studenter ved HiØ. Trivariat tabell.} 
\end{table}\end{frame}


\begin{frame}
\frametitle{Trivariat tabell -- tolkning}
Vi kan sjekke den relative endringen i lønnsforventning for studentene. Her her den forventede lønnsandelen i forhold til gjennomsnittet blant respondentene:
% latex table generated in R 3.0.2 by xtable 1.7-1 package
% Wed Nov 13 04:43:24 2013
\begin{table}[ht]
\centering
{\small
\begin{tabular}{rrrr}
  \hline
 & Bivariat & Studerer ikke realfag & Studerer realfag \\ 
  \hline
Foreldres utd.: Høy & 1.15 & 0.95 & 1.44 \\ 
  Studievalg: Realfag & 1.26 & 0.91 & 1.44 \\ 
   \hline
\end{tabular}
}
\caption{Relativ forventning til lønn} 
\end{table}\end{frame}


\begin{frame}
\frametitle{Trivariat tabell -- tolkning}

\begin{itemize}
\item Studenter med foreldre med høy utdanning forventer seg 15 prosent høyere lønn enn studenter som har foreldre med lav utdanning.
\item Effekten så godt som forsvinner når vi vurderer studieretningen.
\item Studenter som studerer realvag forventer seg i gjennomsnitt  26 prosent høyere lønn enn snittet blant respondentene. 
\item Denne effekten \emph{øker} til 44 prosent når vi tar hensyn til foreldres utdanningsnivå.
\item Derimot forventer studenter som ikke studerer realfag, seg lavere lønn enn snittet. De forventer -9 prosent lavere lønn. Effekten er noe lavere blant studenter med høyt utdannede foreldre: De forventer -5 prosent lavere lønn.
\end{itemize}
\end{frame}



\begin{frame}
\title{Kjikvadrattesten\\
lønnsforventning blant studenter}
\author{}
\institute{}
\maketitle
\end{frame}


\begin{frame}
For å hypoteseteste bør vi følge oppskriften:
\begin{itemize}
\item Velg test: For krysstabeller (kategoriske variabler) er kjikvadrattesten god. For gjennomsnitt (metriske variabler), bruker vi t-testen. 
\item Velg sannsynlighetsnivå: Hvor ofte vil jeg ta feil? Standard er 95 prosents konfidensintervall; det vil si at jeg åpner for å ta feil i 5 prosent av tilfellene.
\item Beregne sannsynlighet: Jeg leser av tabellen for kjikvadratskårer eller t-skårer for å finne toleranseverdien min. Alle verdier mer ekstreme enn den, betyr at jeg forkaster nullhypotesen min og antar at resultatet ikke er tilfeldig.
\end{itemize}
\end{frame}



\begin{frame}
\frametitle{Kjikvadrattest -- velge test}
Kjikvadrattesten er laget for krysstabeller. For kategoriske variabler er krysstabeller den eneste måten å gjøre bivariat statistikk. 
% latex table generated in R 3.0.2 by xtable 1.7-1 package
% Wed Nov 13 04:43:24 2013
\begin{table}[ht]
\centering
{\small
\begin{tabular}{lcc|c}
  \hline
\hline
 & Høy utd. & Lav utd. & Total \\ 
  \hline
Høy lønn & 29 & 5 & 34 \\ 
  Middels lønn & 11 & 7 & 18 \\ 
  Lav lønn & 20 & 27 & 47 \\ 
   \hline
Total & 60 & 39 & 99 \\ 
   \hline
\end{tabular}
}
\end{table}I dette eksempelet er variablene mine kodet til å være kategoriske. I spørreundersøkelsen om forventet lønn blant studenter har jeg kategorisert svarene i tre kategorier: Høy lønn, middels og lav lønn. Er lønnsforventningen tilfeldig fordelt, eller avhenger de av hvorvidt foreldrene har høyere utdannelse (binær variabel)?
\end{frame}


\begin{frame}
\frametitle{Kjikvadrattest -- velge sannsynlighetsnivå}
Jeg ønsker å ta feil i maks 5 prosent av tilfellene. Da må jeg regne ut antall frihetsgrader. I krysstabeller tar ikke testen hensyn til antall enheter i utvalget, men antall verdikombinasjoner (ruter i tabellen). For å beregne frihetsgradene ganger vi antall linjer i tabellen minus \'{e}n med antall kolonner minus \'{e}n:
\begin{equation}
df=(r-1)(k-1)
\end{equation}
\begin{equation}
df=(3-1)(2-1)
\end{equation}
\begin{equation}
df=2
\end{equation}
\end{frame}

\begin{frame}
\frametitle{Kjikvadrattest -- velge sannsynlighetsnivå}
\begin{figure}
\includegraphics[width=0.7\textwidth]{kjitabell.pdf}
\end{figure}
\end{frame}


\begin{frame}
\frametitle{Kjikvadrattest -- velge sannsynlighetsnivå}
Jeg leser av tabellen: i kolonnen med sannsynlighetsnivå på 0.95 (jeg vil ha rett i 95 prosent av tilfellene) finner jeg linjen for 2 frihetsgrader. Her finner jeg den kritiske kjikvadrat-skåren min. Min kritiske verdi er 5,991. Alle verdier mer ekstreme enn den, vil bety signifikante resultater. 
\end{frame}

\begin{frame}
\frametitle{Kjikvadrattest -- beregne sannsynlighetsnivå}
Formelen for kjikvadrat er som følger:
\begin{equation}
\chi^2 = \Sigma\frac{(Observert - forventet)^2}{Forventet}
\end{equation}
Det den i praksis gjør er å beregne forkjsellen mellom hva vi skulle forventet oss når alt er tilfeldig og hva vi faktisk observerte. Siden beregner testen hvor (u)sannsynlig dette utfallet er.
\end{frame}


\begin{frame}
\frametitle{Kjikvadrattest -- observerte frekvenser}
Hvis jeg skulle respektert de univariate fordelingene mine (hvor mange som forventer høy, middels og lav lønn og hvor mange med utdannede foreldre), hva slags verdikombinasjoner skal jeg da se?
% latex table generated in R 3.0.2 by xtable 1.7-1 package
% Wed Nov 13 04:43:24 2013
\begin{table}[ht]
\centering
{\small
\begin{tabular}{rrrr}
  \hline
\hline
 & Høy utd. & Lav utd. & Total \\ 
  \hline
Høy lønn & 29.00 & 5.00 & 34.00 \\ 
  Middels lønn & 11.00 & 7.00 & 18.00 \\ 
  Lav lønn & 20.00 & 27.00 & 47.00 \\ 
   \hline
Total & 60.00 & 39.00 & 99.00 \\ 
  \end{tabular}
}
\end{table}Det beregner jeg ved å multiplisere kolonnenesummene med radsummene i tabellen og dele på antall enheter. Dette er nullhypotesen min!
\\
$\frac{60 \times 34}{99}=20,6$
\end{frame}


\begin{frame}
\frametitle{Kjikvadrattest -- forventede frekvenser (under nullhypotese)}
Hvis jeg skulle respektert de univariate fordelingene mine (hvor mange som forventer høy, middels og lav lønn og hvor mange med utdannede foreldre), hva slags verdikombinasjoner skal jeg da se?
% latex table generated in R 3.0.2 by xtable 1.7-1 package
% Wed Nov 13 04:43:24 2013
\begin{table}[ht]
\centering
{\small
\begin{tabular}{rrr}
  \hline
\hline
 & Høy utd. & Lav utd. \\ 
  \hline
Høy lønn & 20.61 & 13.39 \\ 
  Middels lønn & 10.91 & 7.09 \\ 
  Lav lønn & 28.48 & 18.52 \\ 
   \hline
\end{tabular}
}
\end{table}Det beregner jeg ved å multiplisere kolonnenesummene med radsummene i tabellen og dele på antall enheter. Dette er nullhypotesen min!
\begin{equation}
\frac{60 \times 34}{99}=20,6
\end{equation}
\end{frame}




\begin{frame}
\frametitle{Kjikvadrattest -- differansen mellom observerte og forventede frekvenser}
% latex table generated in R 3.0.2 by xtable 1.7-1 package
% Wed Nov 13 04:43:24 2013
\begin{table}[ht]
\centering
\begin{tabular}{rrr}
  \hline
 & Høy utd. & Lav utd. \\ 
  \hline
Høy lønn & 8.39 & -8.39 \\ 
  Middels lønn & 0.09 & -0.09 \\ 
  Lav lønn & -8.48 & 8.48 \\ 
   \hline
\end{tabular}
\end{table}\begin{equation}
Observert - Forventet
\end{equation}
\end{frame}



\begin{frame}
\frametitle{Kjikvadrattest -- differansen mellom observerte og forventede frekvenser}
% latex table generated in R 3.0.2 by xtable 1.7-1 package
% Wed Nov 13 04:43:24 2013
\begin{table}[ht]
\centering
\begin{tabular}{rrr}
  \hline
 & Høy utd. & Lav utd. \\ 
  \hline
Høy lønn & 70.46 & 70.46 \\ 
  Middels lønn & 0.01 & 0.01 \\ 
  Lav lønn & 71.99 & 71.99 \\ 
   \hline
\end{tabular}
\end{table}Matematikere setter ting i annen når de ønsker å beregne distansen mellom punkter: Da gjør det ikke noe at noe av differansen er negativ og noe er positivt.
\begin{equation}
(Observert - Forventet)^2
\end{equation}
\end{frame}



\begin{frame}
\frametitle{Kjikvadrattest -- differansen normalisert}
% latex table generated in R 3.0.2 by xtable 1.7-1 package
% Wed Nov 13 04:43:24 2013
\begin{table}[ht]
\centering
\begin{tabular}{rrr}
  \hline
 & Høy utd. & Lav utd. \\ 
  \hline
Høy lønn & 3.42 & 5.26 \\ 
  Middels lønn & 0.00 & 0.00 \\ 
  Lav lønn & 2.53 & 3.89 \\ 
   \hline
\end{tabular}
\end{table}\begin{equation}
\frac{(Observert - forventet)^2}{Forventet}
\end{equation}
\begin{equation}
\end{equation}
For å gjøre resultatene sammenliknbare mellom rutene, deler vi resultatet på forventet frekvens.
\end{frame}


\begin{frame}
\frametitle{Kjikvadrattest -- differansen normalisert}
\begin{equation}
\chi^2 = \Sigma\frac{(Observert - forventet)^2}{Forventet}
\end{equation}
\begin{equation}
\chi^2 = 15.1
\end{equation}
Til sist summerer vi alle rutene i tabellen for å få kjikvadratskåren. Jo større skåren er, jo mindre sannsynlig er det at den observerte krysstabellen er oppstått ved en tilfeldighet.

Jeg husker at jeg hadde definert mitt kritiske nivå til 5,991. 15.1 er langt høyere enn det. Det er derfor ikke tilfeldig (med 95 prosent sikkerhet) at vi har observert en forskjell i lønnsforventning blant studenter med foreldre med hhv. høy og lav utdanning.
\end{frame}
\end{document}
